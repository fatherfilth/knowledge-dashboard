---
phase: 04-article-reader
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/app/globals.css
  - mdx-components.tsx
  - src/components/ui/StatusBadge.tsx
  - src/components/ui/ArticleMetadata.tsx
  - src/app/[category]/[slug]/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can read full article content rendered from MDX with readable typography (headings, lists, blockquotes, links all styled)"
    - "Code blocks display with syntax highlighting for multiple languages (JS, Python, bash at minimum)"
    - "Articles show color-coded status badges: in-progress = yellow, complete = green, stable = blue"
    - "Articles display frontmatter metadata: created date, updated date, author, and tags"
    - "Article content flows properly on both mobile (320px+) and desktop without horizontal scroll"
  artifacts:
    - path: "src/components/ui/StatusBadge.tsx"
      provides: "Color-coded status badge component"
      exports: ["StatusBadge"]
    - path: "src/components/ui/ArticleMetadata.tsx"
      provides: "Metadata display with status badge, dates, and author"
      exports: ["ArticleMetadata"]
    - path: "src/app/[category]/[slug]/page.tsx"
      provides: "Article reader page with MDX rendering"
      contains: "MDXRemote"
    - path: "mdx-components.tsx"
      provides: "MDX component mappings for custom elements"
      exports: ["useMDXComponents"]
    - path: "src/app/globals.css"
      provides: "Tailwind typography plugin loaded"
      contains: "@plugin"
  key_links:
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "next-mdx-remote/rsc"
      via: "MDXRemote component with source prop"
      pattern: "MDXRemote.*source"
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "rehype-pretty-code"
      via: "mdxOptions.rehypePlugins in MDXRemote options"
      pattern: "rehypePrettyCode"
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "src/components/ui/StatusBadge.tsx"
      via: "import and render in article header"
      pattern: "StatusBadge"
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "src/components/ui/ArticleMetadata.tsx"
      via: "import and render in article header"
      pattern: "ArticleMetadata"
    - from: "src/app/globals.css"
      to: "@tailwindcss/typography"
      via: "CSS @plugin directive"
      pattern: "@plugin.*typography"
---

<objective>
Transform the article page from raw markdown in a `<pre>` block into a fully rendered MDX reading experience with syntax-highlighted code blocks, styled typography, color-coded status badges, and metadata display.

Purpose: This is the core reading experience -- the reason the site exists. Users need to read articles with proper formatting, highlighted code, and clear metadata to understand the content.
Output: Working article reader with MDX rendering, syntax highlighting, status badges, and metadata display.
</objective>

<execution_context>
@C:/Users/Karl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Karl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-article-reader/04-RESEARCH.md
@.planning/phases/03-routing-static-generation/03-01-SUMMARY.md

# Existing files to modify
@src/app/[category]/[slug]/page.tsx
@src/app/globals.css
@src/types/content.ts
@src/lib/schemas/article.ts
@package.json
@next.config.ts
</context>

<critical_context>
- This project uses Tailwind CSS 4 with `@tailwindcss/postcss`. There is NO `tailwind.config.ts`. The typography plugin must be loaded via `@plugin "@tailwindcss/typography"` in `src/app/globals.css`, NOT via a JS config file.
- Content is fetched from GitHub at build time. MDX rendering happens server-side via `next-mdx-remote/rsc` in async Server Components.
- Since we use `next-mdx-remote/rsc` (NOT `@next/mdx`), rehype/remark plugins are passed directly to `MDXRemote`'s `options` prop as imported functions -- NOT as strings in `next.config`. The Turbopack string-based plugin pitfall does NOT apply to `MDXRemote` options.
- We do NOT need `@next/mdx`, `@mdx-js/loader`, or `@mdx-js/react` -- those are for local MDX files. We only need `next-mdx-remote` for rendering remote content.
- The Article type has: title, status, category, slug, created (Date), updated (Date), author (string), tags (string[]), content (string), path (string).
- Status values from Zod schema: "in-progress", "stable", "complete".
- GITHUB_TOKEN is not set locally. Verification must use TypeScript compilation (`npx tsc --noEmit`), not `npm run build`, unless GITHUB_TOKEN is available.
- `next.config.ts` does NOT need modification for this plan -- all MDX config goes through MDXRemote options.
</critical_context>

<tasks>

<task type="auto">
  <name>Task 1: Install MDX and typography dependencies and configure Tailwind typography plugin</name>
  <files>
    package.json
    src/app/globals.css
    mdx-components.tsx
  </files>
  <action>
    Install the required packages:
    ```
    npm install next-mdx-remote rehype-pretty-code shiki remark-gfm @tailwindcss/typography
    ```

    NOTE: Do NOT install @next/mdx, @mdx-js/loader, or @mdx-js/react -- those are only needed for local MDX files in the app directory. We use next-mdx-remote/rsc which handles compilation internally.

    Update `src/app/globals.css` to load the typography plugin. Add the @plugin directive AFTER the existing @import and @theme:
    ```css
    @import 'tailwindcss';

    @theme inline {
      --font-sans: var(--font-inter);
    }

    @plugin "@tailwindcss/typography";
    ```

    Create `mdx-components.tsx` in the project root (same level as package.json). This file is a convention for MDX in Next.js and provides custom component mappings:
    ```typescript
    import type { MDXComponents } from 'mdx/types';

    export function useMDXComponents(components: MDXComponents): MDXComponents {
      return {
        ...components,
      };
    }
    ```

    This may require installing `@types/mdx` as a dev dependency if the `mdx/types` import fails:
    ```
    npm install -D @types/mdx
    ```
  </action>
  <verify>
    1. `npm ls next-mdx-remote rehype-pretty-code shiki remark-gfm @tailwindcss/typography` -- all packages listed
    2. `npx tsc --noEmit` -- no TypeScript errors (mdx-components.tsx compiles)
    3. Confirm globals.css contains `@plugin "@tailwindcss/typography"`
    4. Confirm mdx-components.tsx exists at project root
  </verify>
  <done>All MDX rendering and typography dependencies are installed. Tailwind typography plugin is configured via CSS @plugin. mdx-components.tsx exists at project root.</done>
</task>

<task type="auto">
  <name>Task 2: Create StatusBadge and ArticleMetadata UI components</name>
  <files>
    src/components/ui/StatusBadge.tsx
    src/components/ui/ArticleMetadata.tsx
  </files>
  <action>
    Create the directory structure: `src/components/ui/`

    Create `src/components/ui/StatusBadge.tsx`:
    - Accept a `status` prop typed as the Article's status union ("in-progress" | "stable" | "complete")
    - Map status to Tailwind color classes:
      - "in-progress": yellow background/text/border (bg-yellow-100 text-yellow-800 border-yellow-200)
      - "complete": green background/text/border (bg-green-100 text-green-800 border-green-200)
      - "stable": blue background/text/border (bg-blue-100 text-blue-800 border-blue-200)
    - Include a fallback for unknown status values (gray)
    - Render as an inline `<span>` with rounded-full, border, px-3, py-1, text-xs, font-medium classes
    - Display the status text inside the badge

    Create `src/components/ui/ArticleMetadata.tsx`:
    - Accept an `article` prop typed as the Article type from `@/types/content`
    - Import and use `StatusBadge` for the status display
    - Layout: horizontal flex-wrap row with gap-3, text-sm, text-gray-600
    - Display elements in order:
      1. StatusBadge with article.status
      2. Created date using `<time>` element with dateTime attribute and toLocaleDateString() display
      3. Updated date (if exists) using `<time>` element with same pattern
      4. Author name (if exists) prefixed with "By"
    - Below the metadata row, display tags if present:
      - Each tag as a rounded pill: bg-gray-100, px-2, py-1, text-xs, text-gray-700
      - Tags row has mb-8 for spacing before article content

    Import the Article type from `@/types/content` (already exists with all needed fields).
  </action>
  <verify>
    1. `npx tsc --noEmit` -- no TypeScript errors
    2. StatusBadge.tsx exports StatusBadge component
    3. ArticleMetadata.tsx exports ArticleMetadata component and imports StatusBadge
    4. StatusBadge has explicit color mappings for all 3 status values plus gray fallback
  </verify>
  <done>StatusBadge renders color-coded badges (yellow/green/blue) for each status value. ArticleMetadata displays status badge, dates with semantic time elements, author, and tag pills.</done>
</task>

<task type="auto">
  <name>Task 3: Replace raw markdown with MDX rendering, syntax highlighting, and responsive prose</name>
  <files>
    src/app/[category]/[slug]/page.tsx
  </files>
  <action>
    Rewrite `src/app/[category]/[slug]/page.tsx` to use MDX rendering:

    Keep ALL existing functionality intact:
    - dynamicParams = false export
    - generateStaticParams using fetchAllArticles (bottom-up pattern)
    - generateMetadata with async params and SEO description
    - notFound() for missing articles
    - Breadcrumb "Back to {Category}" link
    - The same overall page structure (max-w-4xl centered layout)

    Replace the raw content section:
    - Remove the `<pre>` block that displays raw markdown
    - Import `MDXRemote` from `next-mdx-remote/rsc`
    - Import `rehypePrettyCode` from `rehype-pretty-code` (as a function, NOT string)
    - Import `remarkGfm` from `remark-gfm` (as a function, NOT string)
    - Render content with MDXRemote:
      ```tsx
      <MDXRemote
        source={article.content}
        options={{
          mdxOptions: {
            remarkPlugins: [remarkGfm],
            rehypePlugins: [
              [rehypePrettyCode, { theme: 'github-dark-dimmed', keepBackground: true }],
            ],
          },
        }}
      />
      ```

    Replace the metadata section:
    - Remove the inline gray status pill and metadata spans
    - Import and use `ArticleMetadata` component, passing the article object
    - The ArticleMetadata component handles status badge, dates, author, and tags display

    Update the prose wrapper:
    - Wrap MDXRemote in a div with responsive prose classes:
      `prose prose-gray prose-sm md:prose-base lg:prose-lg max-w-none`
    - This ensures mobile-first responsive typography that scales up

    The overall structure should be:
    ```
    <div max-w-4xl centered>
      <breadcrumb />
      <article>
        <h1 title />
        <ArticleMetadata article={article} />
        <div prose responsive>
          <MDXRemote ... />
        </div>
      </article>
    </div>
    ```

    Remove the old tags display section since ArticleMetadata now handles tags.
  </action>
  <verify>
    1. `npx tsc --noEmit` -- no TypeScript errors
    2. page.tsx imports MDXRemote from 'next-mdx-remote/rsc'
    3. page.tsx imports rehypePrettyCode and remarkGfm as functions
    4. page.tsx uses ArticleMetadata component (no inline metadata)
    5. page.tsx has responsive prose classes (prose-sm md:prose-base lg:prose-lg)
    6. No `<pre>` block remains for content display
    7. generateStaticParams and generateMetadata are unchanged
  </verify>
  <done>Article page renders MDX content with syntax highlighting via rehype-pretty-code, responsive typography via Tailwind prose classes, and structured metadata display via ArticleMetadata component. Raw markdown pre block is replaced with proper MDX rendering.</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **TypeScript compilation:** `npx tsc --noEmit` passes with zero errors
2. **Package verification:** `npm ls next-mdx-remote rehype-pretty-code shiki remark-gfm @tailwindcss/typography` shows all installed
3. **File structure check:**
   - `mdx-components.tsx` exists at project root
   - `src/components/ui/StatusBadge.tsx` exists
   - `src/components/ui/ArticleMetadata.tsx` exists
4. **Code verification:**
   - `src/app/[category]/[slug]/page.tsx` contains `MDXRemote` import
   - `src/app/[category]/[slug]/page.tsx` contains `rehypePrettyCode` in options
   - `src/app/[category]/[slug]/page.tsx` contains `remarkGfm` in options
   - `src/app/[category]/[slug]/page.tsx` contains `ArticleMetadata`
   - `src/app/globals.css` contains `@plugin "@tailwindcss/typography"`
5. **No regressions:**
   - `generateStaticParams` still present and unchanged
   - `dynamicParams = false` still exported
   - `generateMetadata` still present with async params pattern

If GITHUB_TOKEN is available, also run `npm run build` to verify full static generation with MDX rendering.
</verification>

<success_criteria>
- Article page renders MDX content instead of raw markdown in a pre block
- Syntax highlighting is configured with rehype-pretty-code using github-dark-dimmed theme
- Status badges are color-coded: yellow for in-progress, green for complete, blue for stable
- Article metadata (dates, author, tags) displays in a structured layout with semantic HTML
- Typography uses responsive Tailwind prose classes (mobile-first scaling)
- All existing routing functionality (static params, metadata, 404s) is preserved
- TypeScript compilation passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/04-article-reader/04-01-SUMMARY.md`
</output>
