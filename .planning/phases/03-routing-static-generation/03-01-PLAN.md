---
phase: 03-routing-static-generation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/page.tsx
  - src/app/not-found.tsx
  - src/app/[category]/page.tsx
  - src/app/[category]/not-found.tsx
  - src/app/[category]/[slug]/page.tsx
  - src/app/[category]/[slug]/not-found.tsx
autonomous: true

must_haves:
  truths:
    - "Homepage route (/) renders and links to all 6 categories"
    - "Category routes (/models, /tools, /skills, /repos, /agents, /projects) each render with article listings"
    - "Article routes (/[category]/[slug]) render for every article in the content repo"
    - "Build completes successfully with all routes generated statically"
    - "Invalid URLs return a styled 404 page"
  artifacts:
    - path: "src/app/[category]/page.tsx"
      provides: "Category listing page with generateStaticParams"
      exports: ["default", "generateStaticParams", "generateMetadata", "dynamicParams"]
      contains: "await params"
    - path: "src/app/[category]/[slug]/page.tsx"
      provides: "Article detail page with generateStaticParams"
      exports: ["default", "generateStaticParams", "generateMetadata", "dynamicParams"]
      contains: "await params"
    - path: "src/app/page.tsx"
      provides: "Homepage with category grid linking to /[category]"
      contains: "fetchCategories"
    - path: "src/app/not-found.tsx"
      provides: "Global 404 page"
      min_lines: 10
    - path: "src/app/[category]/not-found.tsx"
      provides: "Category-level 404 page"
      min_lines: 10
    - path: "src/app/[category]/[slug]/not-found.tsx"
      provides: "Article-level 404 page"
      min_lines: 10
  key_links:
    - from: "src/app/[category]/page.tsx"
      to: "src/lib/content.ts"
      via: "fetchCategoryArticles import"
      pattern: "import.*fetchCategoryArticles.*from.*@/lib/content"
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "src/lib/content.ts"
      via: "fetchCategoryArticles import for article lookup"
      pattern: "import.*fetchCategoryArticles.*from.*@/lib/content"
    - from: "src/app/[category]/[slug]/page.tsx"
      to: "src/lib/content.ts"
      via: "fetchAllArticles in generateStaticParams"
      pattern: "import.*fetchAllArticles.*from.*@/lib/content"
    - from: "src/app/page.tsx"
      to: "src/lib/content.ts"
      via: "fetchCategories import for category grid"
      pattern: "import.*fetchCategories.*from.*@/lib/content"
    - from: "src/app/[category]/page.tsx"
      to: "src/types/content.ts"
      via: "CATEGORIES constant for generateStaticParams"
      pattern: "import.*CATEGORIES.*from.*@/types/content"
---

<objective>
Create the complete App Router route structure for all categories and articles with build-time static generation.

Purpose: This phase establishes every URL in the knowledge dashboard. After this, every category and article has a unique, shareable URL that loads instantly from static HTML. No runtime API calls to GitHub.

Output: 6 route files (3 pages + 3 not-found handlers) covering homepage, category listings, and article detail pages, all statically generated at build time.
</objective>

<execution_context>
@C:/Users/Karl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Karl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 2 summary — we use its content pipeline directly
@.planning/phases/02-data-infrastructure/02-01-SUMMARY.md

# Existing source files this plan depends on
@src/lib/content.ts
@src/lib/github.ts
@src/lib/schemas/article.ts
@src/types/content.ts
@src/app/layout.tsx
@src/app/page.tsx

# Research for this phase
@.planning/phases/03-routing-static-generation/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create category route with generateStaticParams and not-found</name>
  <files>src/app/[category]/page.tsx, src/app/[category]/not-found.tsx</files>
  <action>
Create `src/app/[category]/page.tsx`:

1. Import `CATEGORIES` from `@/types/content` and `fetchCategoryArticles` from `@/lib/content`.
2. Export `const dynamicParams = false` — only pre-generated category routes are valid, all others 404.
3. Export `generateStaticParams` that returns the 6 categories from the CATEGORIES constant: `CATEGORIES.map((category) => ({ category }))`.
4. Export `generateMetadata` that awaits `params` (Promise — Next.js 16 requirement), destructures `category`, and returns `{ title: "${Category} | Ryder.AI", description: "Browse ${category} articles on Ryder.AI" }`. Capitalize the category name for the title (e.g., "Models | Ryder.AI").
5. Export default async `CategoryPage` component that:
   - Awaits `params` to get `category` (CRITICAL: `const { category } = await params` — Next.js 16 breaking change, params is a Promise)
   - Calls `fetchCategoryArticles(category)` to get articles
   - Renders a minimal placeholder page showing: category name as h1, article count, and a list of article titles with links to `/[category]/[slug]` using `next/link`
   - Handles empty category gracefully (shows "No articles in this category yet")
   - Use basic Tailwind classes for readability (max-w-4xl mx-auto, padding, text sizes) — full styling comes in Phase 5

Create `src/app/[category]/not-found.tsx`:
1. Default export component showing "Category Not Found" heading
2. Brief message: "The category you're looking for doesn't exist."
3. Link back to homepage using `next/link`
4. Basic Tailwind styling (centered, readable)

IMPORTANT: The `params` type signature must be `{ params: Promise<{ category: string }> }` in BOTH generateMetadata and the page component. Do NOT use synchronous params — this is a breaking change in Next.js 16.
  </action>
  <verify>Run `npx next build 2>&1 | head -50` and confirm: (1) build starts without TypeScript errors, (2) /[category] routes appear in build output for all 6 categories. If build requires GITHUB_TOKEN, set it from .env.local first.</verify>
  <done>All 6 category routes (/models, /tools, /skills, /repos, /agents, /projects) are generated at build time. Each shows category name, article count, and linked article titles. Invalid categories return 404.</done>
</task>

<task type="auto">
  <name>Task 2: Create article route with generateStaticParams, metadata, and not-found</name>
  <files>src/app/[category]/[slug]/page.tsx, src/app/[category]/[slug]/not-found.tsx</files>
  <action>
Create `src/app/[category]/[slug]/page.tsx`:

1. Import `fetchAllArticles` and `fetchCategoryArticles` from `@/lib/content`.
2. Export `const dynamicParams = false` — only pre-generated article routes are valid.
3. Export `generateStaticParams` that:
   - Calls `fetchAllArticles()` to get every article across all categories
   - Returns `articles.map((article) => ({ category: article.category, slug: article.slug }))` — bottom-up approach returning BOTH params together (research-verified pattern to avoid partial params pitfall)
4. Export `generateMetadata` that:
   - Awaits `params` to get `{ category, slug }`
   - Calls `fetchCategoryArticles(category)` and finds article by slug
   - Returns `{ title: "${article.title} | Ryder.AI" }` if found, `{ title: "Not Found | Ryder.AI" }` if not
   - Adds `description` from first 155 chars of article content (SEO best practice: under 160 chars)
5. Export default async `ArticlePage` component that:
   - Awaits `params` to get `{ category, slug }` (CRITICAL: must await — Next.js 16)
   - Calls `fetchCategoryArticles(category)` and finds article by slug
   - Calls `notFound()` from `next/navigation` if article not found
   - Renders a minimal placeholder page showing: article title as h1, status badge text, category, created/updated dates, tags as comma-separated list, and raw markdown content in a `<pre>` block (MDX rendering comes in Phase 4)
   - Includes a "Back to {category}" link using `next/link`
   - Basic Tailwind styling (max-w-4xl mx-auto, prose-like spacing) — full reader styling comes in Phase 4

Create `src/app/[category]/[slug]/not-found.tsx`:
1. Default export component showing "Article Not Found" heading
2. Brief message: "The article you're looking for doesn't exist."
3. Link back to homepage using `next/link`
4. Basic Tailwind styling (centered, readable)

IMPORTANT: `params` type is `Promise<{ category: string; slug: string }>` in ALL functions.
  </action>
  <verify>Run `npx next build 2>&1` and confirm: (1) no TypeScript errors, (2) /[category]/[slug] routes appear in build output for all articles (~16 articles from Phase 2 verification). Count the generated article routes in build output.</verify>
  <done>All article routes are generated at build time. Each shows article title, metadata (status, dates, tags), and raw content. Invalid article URLs return 404. Build output shows ~16 article routes across 4+ categories.</done>
</task>

<task type="auto">
  <name>Task 3: Update homepage with category grid and add global 404 page</name>
  <files>src/app/page.tsx, src/app/not-found.tsx</files>
  <action>
Update `src/app/page.tsx` (MUST read existing file first):

1. Convert to async Server Component (add `async` to function signature).
2. Import `fetchCategories` from `@/lib/content` and `Link` from `next/link`.
3. Call `fetchCategories()` to get category names and article counts.
4. Keep the existing Ryder.AI branding (h1 title, tagline) but restructure the layout:
   - Ryder.AI title and tagline at top
   - Below the divider, render a grid of 6 category cards (2 cols on mobile via grid-cols-2, 3 cols on lg via lg:grid-cols-3)
   - Each card is a `Link` to `/[category]` showing: capitalized category name and article count (e.g., "3 articles")
   - Cards use subtle border, padding, and hover state (hover:bg-gray-50 or similar)
   - Keep the footer line at bottom
5. Maintain the Linear/Raycast-inspired minimal aesthetic from Phase 1 (gray-900 text, gray-600 secondary, clean whitespace)

Create `src/app/not-found.tsx`:
1. Default export component showing "Page Not Found" heading
2. "The page you're looking for doesn't exist or has been moved."
3. Link back to homepage using `next/link`
4. Styled consistently with the Ryder.AI design (centered, Inter font inherited from layout, gray-900/gray-600 colors)

After both files are created/updated, run a FULL build to verify everything:
- `npm run build` must succeed
- Build output should show: homepage (/), all 6 category routes, all ~16 article routes, and the not-found page
  </action>
  <verify>Run `npm run build` and verify: (1) build succeeds with exit code 0, (2) homepage (/) is in output, (3) all 6 category routes listed, (4) all ~16 article routes listed, (5) no TypeScript errors. Then run `npm run dev` briefly and confirm http://localhost:3000 loads with category grid.</verify>
  <done>Homepage shows Ryder.AI branding with a grid of 6 categories (each linking to /[category] with article counts). Global 404 page exists. Full build succeeds with all routes statically generated — homepage, 6 category pages, ~16 article pages.</done>
</task>

</tasks>

<verification>
Phase-level verification (run after all tasks complete):

1. `npm run build` completes with exit code 0
2. Build output lists `/` (homepage)
3. Build output lists all 6 category routes: `/models`, `/tools`, `/skills`, `/repos`, `/agents`, `/projects`
4. Build output lists article routes for all content (expect ~16 articles)
5. All routes show as static (circle icon, not lambda) in build output
6. `npm run dev` → http://localhost:3000 shows category grid
7. Clicking a category navigates to category page with article list
8. Clicking an article navigates to article page with content
9. Visiting /nonexistent shows 404 page
</verification>

<success_criteria>
- Build succeeds with all routes statically generated
- Homepage renders with 6 category links showing article counts
- All 6 category pages render with article listings
- All ~16 article pages render with title, metadata, and content
- Invalid URLs at every level (global, category, article) show appropriate 404 pages
- No runtime GitHub API calls needed — all content fetched at build time
- Requirement NAV-05 satisfied: each article has unique shareable URL (/[category]/[slug])
</success_criteria>

<output>
After completion, create `.planning/phases/03-routing-static-generation/03-01-SUMMARY.md`
</output>
